# n8n学習・検証ハンズオンガイド

## 📋 学習目的

ContentFlow N8N自動化プラットフォーム実装前に、必要な各ノードの動作検証と知見蓄積を行う。

## 🏗️ 学習環境構成

### 推奨ディレクトリ構造
```
/Users/gotohiro/Documents/user/Products/n8n-learning-lab/
├── README.md
├── CLAUDE.md                    # 学習成果・知見まとめ
├── docker-compose.yml           # n8n環境構築
├── .env.example                 # 環境変数テンプレート
├── docs/                        # 学習ドキュメント
│   ├── setup-guide.md
│   ├── node-reference.md
│   └── troubleshooting.md
├── examples/                    # ワークフロー例
│   ├── basic-nodes/
│   ├── claude-integration/
│   ├── sanity-integration/
│   └── contentflow-simulation/
├── tests/                       # 各ノードテスト
│   ├── 01-basic-nodes/
│   ├── 02-http-requests/
│   ├── 03-claude-api/
│   ├── 04-sanity-api/
│   ├── 05-file-operations/
│   ├── 06-python-scripts/
│   └── 07-error-handling/
└── configs/                     # 設定ファイル
    ├── credentials.json
    └── workflow-templates.json
```

## 🎯 段階別学習プラン

### Phase 1: n8n基礎・環境構築（1-2日）

#### **学習目標**
- n8n基本概念理解
- 環境構築・基本操作習得
- 基本ノードの動作確認

#### **検証項目**
1. **n8n環境構築**
   ```bash
   # Docker環境セットアップ
   # ローカルアクセス確認
   # 基本設定・認証設定
   ```

2. **基本ノード動作確認**
   - Manual Trigger
   - Set Node（データ設定）
   - IF Node（条件分岐）
   - Code Node（JavaScript実行）

#### **実習課題**
```
課題1-1: Manual Triggerで「Hello World」データ作成
課題1-2: Set Nodeでデータ変換・追加
課題1-3: IF Nodeで条件分岐実装
課題1-4: Code Nodeで簡単なデータ処理
```

#### **成果物**
- [ ] n8n環境構築完了
- [ ] 基本ワークフロー作成・実行
- [ ] 各基本ノードの動作確認
- [ ] 知見メモ（CLAUDE.md更新）

### Phase 2: HTTP・API統合（2-3日）

#### **学習目標**
- HTTP Request Nodeの習得
- 外部API統合パターン理解
- Claude API・Sanity API動作確認

#### **検証項目**

##### **2-1: HTTP Request基礎**
```
テスト対象:
- GET リクエスト（JSONPlaceholder API）
- POST リクエスト（テストAPI）
- ヘッダー・認証設定
- レスポンス処理・エラーハンドリング
```

##### **2-2: Claude API統合**
```
検証内容:
- Claude API認証設定
- プロンプト送信・レスポンス受信
- トークン制限・エラー処理
- 長文生成時の分割処理
```

##### **2-3: Sanity API統合**
```
検証内容:
- Sanity管理API認証
- 記事作成・更新・取得
- 画像アップロード・参照
- バッチ処理・エラーハンドリング
```

#### **実習課題**
```
課題2-1: 天気API呼び出し→結果表示
課題2-2: Claude APIで短文生成→結果保存
課題2-3: Sanity APIで記事作成→ID取得
課題2-4: API エラー時の自動リトライ実装
```

#### **成果物**
- [ ] HTTP Request Node習得
- [ ] Claude API統合ワークフロー
- [ ] Sanity API統合ワークフロー
- [ ] エラーハンドリングパターン

### Phase 3: ファイル・データ操作（1-2日）

#### **学習目標**
- ファイル読み書き操作
- JSON・テキスト処理
- データ変換・検証

#### **検証項目**

##### **3-1: ファイル操作**
```
テスト対象:
- Read/Write Binary Files Node
- JSON読み込み・書き出し
- テキストファイル処理
- ファイル存在確認・作成
```

##### **3-2: データ変換**
```
検証内容:
- JSON構造変換
- テキスト→Markdown変換
- データバリデーション
- 条件付きデータ処理
```

#### **実習課題**
```
課題3-1: JSONファイル読み込み→データ抽出
課題3-2: テキスト生成→ファイル保存
課題3-3: 複数ファイルバッチ処理
課題3-4: データ検証・エラー時処理
```

#### **成果物**
- [ ] ファイル操作ノード習得
- [ ] データ変換パターン確立
- [ ] バッチ処理ワークフロー
- [ ] 検証・エラー処理機能

### Phase 4: Python統合・外部スクリプト実行（2-3日）

#### **学習目標**
- Execute Command Node習得
- Python スクリプト実行
- 外部プロセス管理・監視

#### **検証項目**

##### **4-1: Command実行基礎**
```
テスト対象:
- 基本コマンド実行
- 環境変数・パス設定
- 実行結果取得・エラー処理
- タイムアウト・リトライ
```

##### **4-2: Python統合**
```
検証内容:
- Python仮想環境設定
- スクリプト引数渡し・結果取得
- 長時間実行プロセス管理
- Stable Diffusion実行テスト
```

##### **4-3: プロセス監視**
```
検証内容:
- バックグラウンド実行
- 進捗監視・ステータス管理
- プロセス終了検知
- 結果ファイル取得
```

#### **実習課題**
```
課題4-1: 簡単なPythonスクリプト実行
課題4-2: 引数付きスクリプト実行・結果取得
課題4-3: 長時間処理の監視・完了検知
課題4-4: Stable Diffusion テスト画像生成
```

#### **成果物**
- [ ] Execute Command Node習得
- [ ] Python統合パターン確立
- [ ] プロセス監視システム
- [ ] Stable Diffusion動作確認

### Phase 5: エラー処理・監視・通知（1-2日）

#### **学習目標**
- 堅牢なエラーハンドリング
- 監視・ログ・通知システム
- 運用レベル品質確保

#### **検証項目**

##### **5-1: エラーハンドリング**
```
テスト対象:
- Try/Catch ワークフロー
- エラー時の分岐処理
- 自動リトライ（指数バックオフ）
- フォールバック処理
```

##### **5-2: 監視・ログ**
```
検証内容:
- 実行ログ記録・保存
- パフォーマンス監視
- リソース使用量取得
- ダッシュボード表示
```

##### **5-3: 通知システム**
```
検証内容:
- Slack通知設定・送信
- Email通知設定・送信
- 条件付き通知（成功/失敗/警告）
- 通知内容カスタマイズ
```

#### **実習課題**
```
課題5-1: API失敗時の自動リトライ実装
課題5-2: 実行ログのファイル保存
課題5-3: Slack成功・失敗通知実装
課題5-4: 包括的エラーハンドリング作成
```

#### **成果物**
- [ ] エラーハンドリングパターン
- [ ] 監視・ログシステム
- [ ] 通知システム設定
- [ ] 運用品質ワークフロー

### Phase 6: ContentFlow統合シミュレーション（2-3日）

#### **学習目標**
- ContentFlow全体ワークフロー実装
- 既存資産統合・検証
- 本格実装前の最終確認

#### **検証項目**

##### **6-1: 記事生成ワークフロー**
```
シミュレーション内容:
1. HTTP Trigger（テーマ受信）
2. Claude API（記事生成）
3. データ変換・検証
4. Sanity API（記事投稿）
5. 成功通知
```

##### **6-2: 画像生成ワークフロー**
```
シミュレーション内容:
1. 画像プロンプト生成
2. Python実行（Stable Diffusion）
3. プロセス監視・完了待機
4. 画像ファイル確認・取得
5. Sanity画像統合
```

##### **6-3: 統合ワークフロー**
```
シミュレーション内容:
1. 記事生成（並列可能な部分特定）
2. 画像生成（並列実行）
3. 統合処理（記事+画像）
4. Git操作（自動コミット）
5. 完了通知・レポート
```

#### **実習課題**
```
課題6-1: 記事生成ミニワークフロー作成
課題6-2: 画像生成ミニワークフロー作成
課題6-3: エラー時の復旧フロー作成
課題6-4: 完全統合ワークフロー実装
```

#### **成果物**
- [ ] ContentFlow記事生成ワークフロー
- [ ] ContentFlow画像生成ワークフロー
- [ ] 統合ワークフロープロトタイプ
- [ ] 実装課題・改善点リスト

## 📝 学習成果まとめ（CLAUDE.md記録項目）

### 各Phaseで記録すべき内容

#### **基本情報**
```markdown
## Phase X: [フェーズ名]

### 学習日時
- 開始: YYYY-MM-DD
- 完了: YYYY-MM-DD  
- 所要時間: X時間

### 達成目標
- [x] 目標1
- [x] 目標2
- [ ] 課題・未達成項目
```

#### **技術知見**
```markdown
### 動作確認済みノード
- ノード名: 動作状況・設定のコツ
- 制約・注意事項
- パフォーマンス・推奨設定

### エラー・トラブルシューティング
- 発生したエラー内容
- 原因・解決方法
- 予防策・改善点

### ベストプラクティス
- 効率的な設定方法
- 推奨ワークフローパターン
- 避けるべき設定・パターン
```

#### **ContentFlow適用性評価**
```markdown
### 適用可能性
- 検証したノード・機能
- ContentFlowでの実用性（5段階評価）
- 必要な修正・カスタマイズ

### 課題・リスク
- 技術的制約・限界
- 運用上の注意点
- 代替案・回避策

### 次段階への提言
- 本格実装での注意点
- 追加検証が必要な項目
- 優先実装すべき機能
```

## 🛠️ 実践的な学習方法

### 環境構築手順
```bash
# 1. 学習ディレクトリ作成
mkdir -p /Users/gotohiro/Documents/user/Products/n8n-learning-lab
cd n8n-learning-lab

# 2. 基本構造作成
mkdir -p {docs,examples,tests,configs}

# 3. n8n環境構築
# Docker または npm install n8n

# 4. 学習開始
# Phase 1から順次実施
```

### 日次学習ルーティン
```
1. 前日の復習・課題確認（15分）
2. 新しいノード・機能学習（60分）
3. 実習課題実施（45分）
4. 学習成果記録・知見まとめ（30分）
5. 次日の学習計画（10分）
```

### 検証基準
```
各ノード・機能について:
✅ 基本動作確認
✅ エラーケース確認
✅ パフォーマンス確認
✅ ContentFlow適用性評価
✅ 知見・注意点まとめ
```

## 🎯 学習完了条件

### 必須達成項目
- [ ] 全Phase（1-6）完了
- [ ] 各ノードの動作確認済み
- [ ] ContentFlow統合ワークフロー作成
- [ ] CLAUDE.md知見まとめ完了
- [ ] 本格実装課題リスト作成

### 推奨達成項目  
- [ ] 複数の代替実装パターン検証
- [ ] パフォーマンス・スケーラビリティ検証
- [ ] エラー・復旧パターン網羅
- [ ] 運用・監視システム構築

### 次段階への移行条件
- [ ] ContentFlow-N8N実装の技術的確信
- [ ] 主要リスク・課題の明確化
- [ ] 実装スケジュール・工数見積もり
- [ ] 成功可能性の客観的評価

## 📚 参考リソース

### 公式ドキュメント
- [n8n Documentation](https://docs.n8n.io/)
- [n8n Community](https://community.n8n.io/)
- [n8n Workflow Templates](https://n8n.io/workflows/)

### 学習リソース
- n8n YouTube チュートリアル
- Community ワークフロー例
- GitHub n8n-nodes repository

### ContentFlow関連
- sanity-edition/CLAUDE.md（技術課題・解決策）
- sanity-edition/scripts/（移植対象コード）
- PRD_n8n.md（要件・設計）

---

**📝 作成日**: 2025-01-27  
**🎯 学習期間**: 1-2週間（Phase 1-6）  
**📋 更新**: 学習進捗に応じてCLAUDE.mdに知見蓄積  
**🔄 活用**: ContentFlow-N8N本格実装にフィードバック