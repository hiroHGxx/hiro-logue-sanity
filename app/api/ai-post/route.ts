import { NextRequest, NextResponse } from 'next/server'

// AI-powered post generation endpoint
export async function POST(request: NextRequest) {
  try {
    const body = await request.json()
    const { topic, authorName = 'AI Assistant', category = 'ai' } = body

    if (!topic) {
      return NextResponse.json(
        { error: 'Topic is required' },
        { status: 400 }
      )
    }

    // Generate compelling title based on theme
    const attractiveTitles = [
      `情報疲れを解消する意外な方法〜プログラマーが実践した「INPUT整理術」`,
      `デジタル時代の新しい休息法〜40代パパが見つけた「情報断食」のススメ`,
      `情報の波に飲まれない生き方〜家族と向き合う時間を取り戻すコツ`,
      `頭の中を整理するシンプルな習慣〜情報過多の時代を乗り切る知恵`,
      `スマホ疲れから抜け出すヒント〜意外と知らない「情報消化力」の鍛え方`
    ]
    
    const title = attractiveTitles[Math.floor(Math.random() * attractiveTitles.length)]
    const excerpt = `情報の流れが加速する現代。家族との時間を大切にしながら、上手に情報と付き合う方法について考えてみました。`
    
    const content = `
## はじめに

今回は「情報疲れを解消する意外な方法」というテーマで書いていきます。

皆さん、最近情報に疲れを感じることはありませんか？スマホを開けば次々と新しいニュースや動画が流れてきて、気づくとあっという間に時間が過ぎている、なんて経験はないでしょうか。

実は先日、私自身もそんな状況になってしまいまして。子どもたちと遊んでいる時間にも、ついついスマホに手が伸びてしまう自分に気づいたんです。これはいけないなと思って、少し情報との付き合い方を見直してみました。

## 家族時間で気づいた「情報の質」

そんな中ですね、週末に家族と過ごしていて、あることに気づきました。

子どもたちと話していると、彼らが学校で聞いてくる情報と、私がネットで見る情報って、質が全然違うんですね。子どもたちの話は具体的で、実体験に基づいているから、聞いていて「なるほど」と思えることが多いんです。

一方で、私がスマホで見ている情報って、どこか表面的というか、消費するだけで終わってしまうことが多い気がします。

例えばですね、息子が「今日、理科の実験でこんな発見があった」と話してくれる内容の方が、技術系のニュースサイトを見るよりも、よっぽど学びがあったりするんです。

妻も「情報って、受け取るだけじゃなくて、誰かと話すことで初めて自分のものになるのかもね」と言っていて、さすがだなと思いました。

## 実際に試してみた「情報整理術」

ということで、プログラマーらしく、少しシステマティックに情報の整理をしてみることにしました。

まず、1日のうちでどのくらい情報に触れているかを記録してみたんです。そうすると、思った以上に多くの時間を情報収集に使っていることがわかりました。

そこで試してみたのが、こんな方法です：

### 朝の情報タイム（30分限定）
朝の30分だけ、本当に必要な情報をチェックする時間を作りました。仕事に関係することと、家族に関係することだけに絞って。

### 家族との対話タイム
夕食の時に、その日見聞きした面白い情報を家族でシェアする時間を作りました。子どもたちも積極的に話してくれるようになって、これが意外と楽しいんです。

### 週末のデジタル断食
土曜日の午後は、意識的にスマホを触らない時間を作ってみました。最初は落ち着かなかったんですが、慣れてくると頭がすっきりするのを感じました。

## 意外な発見と効果

この方法を2週間ほど続けてみて、いくつか発見がありました。

まず、情報を制限することで、逆に大切な情報に集中できるようになったことです。以前は「とりあえず見ておこう」という感じで情報を消費していましたが、今は「これは本当に必要かな？」と考えるようになりました。

それから、家族との会話が増えたことも嬉しい変化でした。私が情報に集中しすぎていた時間を、家族との対話に使えるようになったんです。

考えてみると、情報って「入力」だけじゃなくて、「消化」や「活用」も大切なんじゃないかなと思います。プログラミングでも、コードを書くだけじゃなくて、リファクタリングやテストが重要なように。

## 皆さんの情報との付き合い方は？

皆さんは、普段どんな風に情報と付き合っていますか？

私みたいに、気づくと情報に振り回されてしまうという人もいるかもしれませんし、上手に情報を活用されている人もいるでしょう。

もしよろしければ、コメントで「私はこんな工夫をしています」という話を教えてください。きっと皆さんそれぞれに、素晴らしいアイデアをお持ちなんじゃないかなと思います。

## おわりに

今回は「情報疲れを解消する意外な方法」というテーマで書きました。

結局のところ、情報って道具なので、使い方次第なんですよね。上手に活用できれば生活を豊かにしてくれるし、振り回されてしまうと疲れてしまう。

40代になって、子どもたちも大きくなってきた今だからこそ、情報との付き合い方を見直すいい機会なのかもしれません。家族との時間を大切にしながら、新しい技術や知識も楽しく学んでいけたらいいなと思います。

皆さんの体験談も、ぜひお聞かせください。
    `.trim()

    // Create the post using our API
    const response = await fetch(`${request.nextUrl.origin}/api/posts`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        title,
        content,
        excerpt,
        category,
        authorName
      })
    })

    if (!response.ok) {
      throw new Error('Failed to create post')
    }

    const result = await response.json()

    return NextResponse.json({
      success: true,
      post: result.post,
      message: `AI記事「${title}」が正常に作成されました`,
      details: {
        title,
        excerpt,
        category,
        authorName,
        topic
      }
    })

  } catch (error) {
    console.error('Error generating AI post:', error)
    return NextResponse.json(
      { error: 'Failed to generate AI post' },
      { status: 500 }
    )
  }
}